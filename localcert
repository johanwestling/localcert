#!/bin/bash
. ./helpers/bash.sh

mkcert_path=".mkcert"
mkcert_bin="$mkcert_path/mkcert$(os_binary_extension)"

echo ""
echo "Localcert"
echo "========="
echo ""

if [ -z $(mkcert_installed) ]; then
	echo "-> Downloading $LOCAL_CERT_BINARY"
	if [ -n $(mkcert_download) ]; then
		echo "   Done"
		echo ""
	else
		echo "   Failed"
		echo ""
		exit 1
	fi
fi

for arg in "$@"; do
	case $arg in
		"--install")
			echo "-> Installing rootCA"
			mkcert_exec -install
			echo "   Done"
			echo ""
		;;
	esac
done


# echo "-> Installing rootCA"
# mkcert_exec $mkcert_bin \
# 	-install
# echo "   Done"
# echo ""

# echo "-> Copying rootCA"
# if [ -n $(mkcert_copy $(mkcert_root_path $mkcert_bin) $mkcert_path/certificates/) ]; then
# 	echo "   Done"
# 	echo ""
# else 
# 	echo "   Failed"
# 	echo ""
# 	exit 1
# fi

# echo "-> Generate rfsisu certificates"
# mkcert_exec $mkcert_bin -key-file="$mkcert_path/certificates/rfsisu-key.pem" -cert-file="$mkcert_path/certificates/rfsisu.pem" rfsisu.local.aventyret.com "*.rfsisu.local.aventyret.com"
# echo "   Done"
# echo ""
